angular.module("orthologView").component("orthologView",{bindings:{locusTag:"<"},controller:"orthologCtrl",templateUrl:"/static/wiki/js/angular_templates/ortholog-view.html"}).controller("orthologCtrl",function(orthoData,InterPro,hostPathogen,GOTerms,OperonData,expressionTimingData,$filter,sendToView,$location){"use strict";var ctrl=this;ctrl.data={},ctrl.reference="",orthoData.getOrthologs(ctrl.locusTag).then(function(response){angular.forEach(response.results.bindings,function(obj){ctrl.hasOrthologs=!0,ctrl.data[obj.orthoTaxid.value]={locusTag:obj.orthoLocusTag.value,taxid:obj.orthoTaxid.value},obj.reference&&(ctrl.reference=obj.reference.value),obj.uniprot?(InterPro.getInterPro(obj.uniprot.value).then(function(data){ctrl.data[obj.orthoTaxid.value].ip=0<data.length}),hostPathogen.getHostPathogen(obj.uniprot.value).then(function(data){ctrl.data[obj.orthoTaxid.value].hp=0<data.length}),GOTerms.getGoTerms(obj.uniprot.value).then(function(data){var dataResults=data.data.results.bindings;ctrl.data[obj.orthoTaxid.value].go=0<dataResults.length;var ecnumber=[];angular.forEach(dataResults,function(value,key){value.hasOwnProperty("ecnumber")&&-1==ecnumber.indexOf(value.ecnumber.value)&&ecnumber.push(value.ecnumber.value)});var annotation_keys={locusTag:obj.orthoLocusTag.value,taxid:obj.orthoTaxid.value,ec_number:ecnumber},url_suf=$location.path()+"/mg_mutant_view";sendToView.sendToView(url_suf,annotation_keys).then(function(data){ctrl.data[obj.orthoTaxid.value].mutant=0<data.data.mutants.length})})):(ctrl.data[obj.orthoTaxid.value].ip=!1,ctrl.data[obj.orthoTaxid.value].hp=!1,ctrl.data[obj.orthoTaxid.value].go=!1),OperonData.getOperonData(obj.entrez.value).then(function(data){ctrl.data[obj.orthoTaxid.value].operon=0<data.data.results.bindings.length}),expressionTimingData.getExpression(function(data){var current=$filter("keywordFilter")(data,obj.orthoLocusTag.value),currentExpression={};angular.forEach(current[0],function(value,key){"_id"!=key&&"$oid"!=key&&"timestamp"!=key&&(currentExpression[key]=value)}),ctrl.data[obj.orthoTaxid.value].expression=null!=currentExpression.RB_EXPRESSION_TIMING})})}),ctrl.tSettings={strain:!0,tax:!0,cLocus:!0,dLocus:!1,identity:!1,length:!1,eval:!1,ref:!0,expression:!0,go:!0,operons:!0,mutants:!0,interpro:!0,hostPathogen:!0}});