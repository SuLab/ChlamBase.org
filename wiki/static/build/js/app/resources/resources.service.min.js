angular.module("resources").factory("allOrgs",function($resource){return $resource("/static/wiki/json/orgsList.json",{},{getAllOrgs:{method:"GET",params:{},isArray:!0,cache:!0}})}),angular.module("resources").factory("allChlamOrgs",function($resource){return $resource("/static/wiki/json/chlamsOrgList.json",{},{getAllOrgs:{method:"GET",params:{},isArray:!0,cache:!0}})}),angular.module("resources").factory("evidenceCodes",function($resource){return $resource("/static/wiki/json/evidence_codes.json",{},{getevidenceCodes:{method:"GET",params:{},isArray:!0,cache:!0}})}),angular.module("resources").factory("mutantData",function($resource){return $resource("/static/wiki/json/kokes.json",{},{getKokesMutants:{method:"GET",params:{},isArray:!0,cache:!0}})}),angular.module("resources").factory("expressionTimingData",function($resource){return $resource("/static/wiki/json/expression_timing.json",{},{getExpression:{method:"GET",params:{},isArray:!0,cache:!0}})}),angular.module("resources").factory("orthoData",function($http,$q){return{getOrthologs:function(locusTag){var deferred=$q.defer(),url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT ?orthoLocusTag ?orthoTaxid ?entrez ?uniprot ?refseq WHERE {{?gene wdt:P2393 '"+locusTag+"'.?gene wdt:P684 ?ortholog.?ortholog wdt:P2393 ?orthoLocusTag.?ortholog wdt:P703 ?orthoTaxon.?orthoTaxon wdt:P685 ?orthoTaxid.?ortholog wdt:P351 ?entrez.OPTIONAL {?ortholog wdt:P688 ?protein.?protein wdt:P352 ?uniprot.?protein wdt:P637 ?refseq.}}UNION{?gene wdt:P2393 '"+locusTag+"'.?gene wdt:P2393 ?orthoLocusTag.?gene wdt:P703 ?orthoTaxon.?orthoTaxon wdt:P685 ?orthoTaxid.?gene wdt:P351 ?entrez.OPTIONAL {?gene wdt:P688 ?protein.?protein wdt:P352 ?uniprot.?protein wdt:P637 ?refseq.}}}");return $http.get(url).success(function(response){deferred.resolve(response)}).error(function(response){deferred.reject(response)}),deferred.promise}}}),angular.module("resources").factory("sendToView",function($http){return{sendToView:function(url_suffix,data){console.log(data);var url=url_suffix;return $http.post(url,data).success(function(data){return data}).error(function(data,status){return status})}}}),angular.module("resources").factory("uploadFile",function($http){return{uploadFile:function(url_suffix,data){var url=url_suffix;return $http.post(url,data).success(function(data){return data}).error(function(data,status){return status})}}}),angular.module("resources").factory("currentOrgFetch",function($http){return{getCurrentOrg:function(taxid){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT ?taxid ?taxon ?taxonLabel WHERE{ ?taxon wdt:P685 '"+taxid+"'. SERVICE wikibase:label { bd:serviceParam wikibase:language 'en' . } }");return $http.get(url).then(function(response){var results=response.data.results.bindings;return{taxid:taxid,taxon:results[0].taxon.value,taxonLabel:results[0].taxonLabel.value}})}}}),angular.module("resources").factory("speciesGenes",function($http){return{getSpeciesGenes:function(taxid){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT ?protein ?proteinLabel ?uniprot WHERE{ ?taxon wdt:P685 '"+taxid+'\'. ?protein wdt:P352 ?uniprot;wdt:P703 ?taxon;rdfs:label ?proteinLabel.FILTER (lang(?proteinLabel) = "en") }');return console.log(url),$http.get(url).success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("allOrgGenes",function($http){return{getAllOrgGenes:function(taxid){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT ?gene ?geneLabel ?proteinLabel ?protein ?entrez ?refseqProt ?locusTag ?uniprot ?chromosome ?chromosomeLabel ?refSeqChromosome ?refSeqChromosomeLabel ?genStart ?genEnd ?strand (group_concat(?aliases;separator=', ') as ?alias) WHERE{ ?taxon wdt:P685 '"+taxid+"'. ?gene wdt:P703 ?taxon; wdt:P279 wd:Q7187; wdt:P2393 ?locusTag; wdt:P351 ?entrez; wdt:P644 ?genStart; wdt:P645 ?genEnd; wdt:P2548 ?strand; skos:altLabel ?aliases. OPTIONAL {?gene wdt:P688 ?protein; wdt:P352 ?uniprot; wdt:P637 ?refseqProt. }?gene p:P644 ?chr. ?chr pq:P1057 ?chromosome. ?chromosome wdt:P2249 ?refSeqChromosome.SERVICE wikibase:label { bd:serviceParam wikibase:language 'en' .}} GROUP BY ?gene ?geneLabel ?protein ?proteinLabel ?entrez ?refseqProt ?locusTag ?uniprot ?chromosome ?chromosomeLabel ?genStart ?genEnd ?strand ?refSeqChromosome ?refSeqChromosomeLabel ");return console.log("Loading all organism genes"),$http.get(url).success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("allOrgOperons",function($http){return{getAllOrgOperons:function(taxid){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT ?operon ?operonLabel WHERE{ ?taxon wdt:P685 '"+taxid+"'. ?operon wdt:P703 ?taxon; wdt:P279 wd:Q139677. SERVICE wikibase:label { bd:serviceParam wikibase:language 'en' .}} ");return $http.get(url).success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("GOTerms",function($http){return{getGoTerms:function(uniprot){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT  distinct ?gotermValueLabel ?goID ?gotermValue ?goclass ?determinationLabel ?reference_stated_inLabel ?reference_retrievedLabel ?ecnumber WHERE { ?protein wdt:P352 '"+uniprot+'\'. {?protein p:P680 ?goterm} UNION {?protein p:P681 ?goterm} UNION {?protein p:P682 ?goterm}.  ?goterm pq:P459 ?determination .OPTIONAL {?goterm prov:wasDerivedFrom/pr:P248 ?reference_stated_in .}OPTIONAL {?goterm prov:wasDerivedFrom/pr:P813 ?reference_retrieved .}OPTIONAL {?goterm prov:wasDerivedFrom/pr:P698 ?pmid .}{?goterm ps:P680 ?gotermValue} UNION {?goterm ps:P681 ?gotermValue} UNION {?goterm ps:P682 ?gotermValue}.  ?gotermValue wdt:P279* ?goclass; wdt:P686 ?goID. FILTER ( ?goclass = wd:Q2996394 || ?goclass = wd:Q5058355 || ?goclass = wd:Q14860489) OPTIONAL {?gotermValue wdt:P591 ?ecnumber.}SERVICE wikibase:label { bd:serviceParam wikibase:language "en" .}}');return $http.get(url).success(function(response){return response.data}).error(function(response){return response})}}}),angular.module("resources").factory("InterPro",function($http){return{getInterPro:function(uniprot){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT distinct ?protein ?interPro_item ?interPro_label ?ipID ?reference_stated_inLabel ?refURL WHERE {?proteinLabel wdt:P352'"+uniprot+'\';p:P527 ?interPro.?interPro ps:P527 ?interPro_item.?interPro prov:wasDerivedFrom/pr:P248 ?reference_stated_in ;prov:wasDerivedFrom/pr:P854 ?refURL .?interPro_item wdt:P2926 ?ipID;rdfs:label ?interPro_label. SERVICE wikibase:label { bd:serviceParam wikibase:language "en" .}filter (lang(?interPro_label) = "en") .}');return $http.get(url).then(function(response){return response.data.results.bindings})}}}),angular.module("resources").factory("RefSeqChrom",function($http){return{getRefSeqChrom:function(locusTag){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT ?refSeqChromosome WHERE{ \n  ?gene wdt:P2393 '"+locusTag+"';        p:P644 ?chr.\n  ?chr pq:P1057 ?chromosome. \n  ?chromosome wdt:P2249 ?refSeqChromosome.\n  SERVICE wikibase:label { bd:serviceParam wikibase:language 'en' .}\n} \n");return $http.get(url).then(function(response){return response.data.results.bindings})}}}),angular.module("resources").factory("hostPathogen",function($http){return{getHostPathogen:function(uniprot){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent('SELECT ?host ?hostLabel ?protein ?proteinLabel ?hostProtein ?hostGeneLabel ?hostProteinLabel ?reference_stated_in ?reference_stated_inLabel ?pmid (group_concat(distinct ?determination ;separator=", ") as ?dmethod) (group_concat(distinct ?det_label ;separator=", ") as ?dmethodLabel) WHERE{ ?protein wdt:P352 \''+uniprot+'\'; wdt:P129 ?hostProtein; p:P129 ?hpClaim. ?hpClaim prov:wasDerivedFrom/pr:P248 ?reference_stated_in; pq:P459 ?determination. ?determination rdfs:label ?det_label. ?reference_stated_in wdt:P698 ?pmid. ?hostProtein wdt:P703 ?host; wdt:P702 ?hostGene. FILTER (lang(?det_label) = "en") SERVICE wikibase:label { bd:serviceParam wikibase:language "en" .}} GROUP BY ?protein ?hostGeneLabel ?proteinLabel ?reference_stated_in ?reference_stated_inLabel ?pmid ?hostProtein ?hostProteinLabel ?host ?hostLabel');return console.log("Loading host pathogen with uniprot "+uniprot),$http.get(url).then(function(response){return response.data.results.bindings})}}}),angular.module("resources").factory("OperonData",function($http){return{getOperonData:function(entrez){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT ?gene ?locusTag ?entrez ?operon ?operonLabel ?operonItem  ?operonItemLabel ?genStart ?genEnd ?strand ?strandLabel ?op_genes ?reference_stated_in ?reference_stated_inLabel ?op_genesLabel ?reference_pmid WHERE { ?gene wdt:P351 '"+entrez+"'; p:P361 ?operon. ?operon ps:P361 ?operonItem. ?operonItem wdt:P279 wd:Q139677; wdt:P527 ?op_genes. ?op_genes wdt:P2393 ?locusTag; wdt:P351 ?entrez; wdt:P644 ?genStart; wdt:P645 ?genEnd; wdt:P2548 ?strand.OPTIONAL { ?operon prov:wasDerivedFrom/pr:P248 ?reference_stated_in. ?reference_stated_in wdt:P698 ?reference_pmid. } SERVICE wikibase:label { bd:serviceParam wikibase:language 'en' . }}");return $http.get(url).success(function(response){return response.data}).error(function(response){return response})}}}),angular.module("resources").factory("expasyData",function($http){return{getReactionData:function(ecNumber){var url="https://chlambase.org/expasy/EC/{ecnumber}.txt".replace("{ecnumber}",ecNumber);return $http.get(url).then(function(response){var reactionData={reaction:[]},responseData=response.data.split("\n");return angular.forEach(responseData,function(value,key){if(value.match("^ID")&&(reactionData.ecnumber=value.slice(5)),value.match("^CA ")){var trimmedReaction=value.replace(/^(CA)/,"");reactionData.reaction.push(trimmedReaction)}}),reactionData},function(response){return response})}}}),angular.module("resources").factory("pubMedData",function($http){return{getPMID:function(val){var url="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pubmed&retmode=json&id="+val;return $http.get(url).success(function(response){return response.result[val]}).error(function(response){return response})}}}),angular.module("resources").factory("locusTag2Pub",function($http){return{getlocusTag2Pub:function(val){var url="https://www.ebi.ac.uk/europepmc/webservices/rest/search?query=chlamydia%20{locusTag}&format=json".replace("{locusTag}",val);return $http.get(url).success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("euroPubData",function($http){return{getEuroPubData:function(val){var url="https://www.ebi.ac.uk/europepmc/webservices/rest/search?query={pubmedID}&resulttype=core&format=json".replace("{pubmedID}",val);return $http.get(url).success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("pubLinks",function($http,$filter){return{getPubLinks:function(entrez){var url="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=gene&db=pubmed&id={entrez}&retmode=json&linkname=gene_pubmed_pmc_nucleotide".replace("{entrez}",entrez);return $http.get(url).success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("recentChlamPubLinks",function($http){return{getRecentChlamPubLinks:function(entrez){return $http.get("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pubmed&term=chlamydia trachomatis&reldate=10&datetype=edat&retmax=100&usehistory=y&retmode=json").success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("allGoTerms",function($http){return{getGoTermsAll:function(val,goClass){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT DISTINCT ?goterm ?goID ?goterm_label WHERE { ?goterm wdt:P279* wd:"+goClass+"; rdfs:label ?goterm_label; wdt:P686 ?goID. FILTER(lang(?goterm_label) = 'en') FILTER(CONTAINS(LCASE(?goterm_label), '"+val.toLowerCase()+"' ))}");return $http.get(url).success(function(response){return response.data}).error(function(response){return response})}}}),angular.module("resources").factory("allChlamydiaGenes",function($http){return{getAllChlamGenes:function(){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT ?taxon ?taxid ?taxonLabel ?gene ?geneLabel ?entrez  ?uniprot ?protein ?proteinLabel ?locusTag ?geneDescription ?refseq_prot ?aliases WHERE {  ?taxon wdt:P171* wd:Q846309.  ?gene wdt:P279 wd:Q7187;  wdt:P703 ?taxon;  wdt:P351 ?entrez;  wdt:P2393 ?locusTag;  wdt:P688 ?protein;  skos:altLabel ?aliases.?protein wdt:P352 ?uniprot;  wdt:P637 ?refseq_prot. ?taxon wdt:P685 ?taxid.SERVICE wikibase:label {bd:serviceParam wikibase:language 'en'.}}");return $http.get(url).success(function(response){return response.data}).error(function(response){return response})}}}),angular.module("resources").factory("wdGetEntities",function(){return{wdGetEntities:function(qid){return $.ajax({url:"https://www.wikidata.org/w/api.php",jsonp:"callback",dataType:"jsonp",data:{action:"wbgetentities",ids:qid,format:"json"},xhrFields:{withCredentials:!0},success:function(response){return response},error:function(response){return response}})}}}),angular.module("resources").factory("entrez2QID",function($http,$filter){return{getEntrez2QID:function(entrez){var url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent("SELECT distinct ?gene ?protein WHERE{?gene wdt:P351 '{entrez}'; wdt:P688 ?protein.}".replace("{entrez}",entrez));return $http.get(url).success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("locusTag2QID",function($http,$filter){return{getLocusTag2QID:function(locusTag,taxid){var url1="SELECT distinct ?gene ?protein WHERE{?strain wdt:P685 '{taxid}'. ?gene wdt:P2393 '{locusTag}'; wdt:P703 ?strain. OPTIONAL {?gene wdt:P688 ?protein.}}".replace("{taxid}",taxid).replace("{locusTag}",locusTag),url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent(url1);return $http.get(url).success(function(response){return response}).error(function(response){return response})}}}),angular.module("resources").factory("abstractSPARQL",function($http){return{getAbstractSPARQL:function(pqid,pred,idprop){var url1="PREFIX wd: <https://www.wikidata.org/entity/> PREFIX prov: <https://www.w3.org/ns/prov#> PREFIX pr: <https://www.wikidata.org/prop/reference/> PREFIX p: <https://www.wikidata.org/prop/> PREFIX ps: <https://www.wikidata.org/prop/statement/> SELECT (wd:prot_qid as ?sub) ?obj ?objLabel ?objDescription ?obj_id ?stated_in ?stated_inLabel ?retrieved ?reference_url ?language ?languageLabel ?curator ?curatorLabel ?determination ?determinationLabel WHERE {  wd:prot_qid p:an_prop ?claim .  ?claim ps:an_prop ?obj.  ?obj wdt:id_prop ?obj_id.   optional {?claim prov:wasDerivedFrom/pr:P248 ?stated_in. }   optional {?claim prov:wasDerivedFrom/pr:P813 ?retrieved. }   optional {?claim prov:wasDerivedFrom/pr:P854 ?reference_url. }   optional {?claim prov:wasDerivedFrom/pr:P407 ?language. }   optional {?claim prov:wasDerivedFrom/pr:P1640 ?curator. }   optional {?claim pq:P459 ?determination. }   SERVICE wikibase:label {         bd:serviceParam wikibase:language 'en' .  } }".replace(/prot_qid/g,pqid).replace(/an_prop/g,pred).replace(/id_prop/g,idprop),url="https://query.wikidata.org/sparql?format=json&query="+encodeURIComponent(url1);return console.log(url1),$http.get(url).success(function(response){return response}).error(function(response){return response})}}});